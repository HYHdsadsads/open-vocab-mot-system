开放词汇多目标跟踪系统
项目简介
本项目实现了一个基于开放词汇 (Open Vocabulary) 的多目标跟踪系统，支持对未知类别目标的检测与跟踪。系统结合了计算机视觉、知识图谱和零样本学习技术，能够在动态环境中识别和追踪多种目标类型。
核心功能
支持自定义类别目标的检测与跟踪
集成知识图谱增强语义理解能力
实现零样本学习以处理未知类别目标
提供多模态特征融合与可靠性评估
支持视频输入处理与结果可视化
环境配置
依赖项
Python 3.10
torch 2.0.1
ultralytics 8.0.196
clip 1.0
scikit-learn 1.2.2
OpenCV
NumPy
PIL
安装方法
bash
运行
# 克隆仓库
git clone <仓库地址>
cd <项目目录>

# 安装依赖
pip install -r requirements.txt
目录结构
plaintext
pythonProject2/
├── pipeline/             # 系统主流程模块
│   └── system.py         # 跟踪系统主类
├── models/               # 模型相关模块
│   ├── backbone.py       # 骨干网络
│   ├── dictionary.py     # 跨模态词典
│   ├── proto_memory.py   # 原型记忆模块
│   └── reliability_head.py # 可靠性评估器
├── knowledge_graph/      # 知识图谱相关
│   ├── knowledge_graph.json # 知识图谱数据
│   ├── classes.npy       # 类别列表
│   └── embeddings.npy    # 知识图谱嵌入
├── zero_shot/            # 零样本学习模块
│   └── handler.py        # 零样本处理器
├── config.py             # 配置文件
└── main.py               # 系统入口
配置说明
所有配置集中在config.py文件中，主要包括：
DATASET_CONFIG: 数据集路径和格式配置
MODEL_CONFIG: 模型路径和设备配置
KG_CONFIG: 知识图谱相关配置
TRACKER_CONFIG: 跟踪器参数配置
ZERO_SHOT_CONFIG: 零样本学习配置
其他模块的超参数配置
可根据实际需求修改对应配置项。
使用方法
1. 生成测试视频（可选）
系统提供了生成测试视频的功能，包含多种目标类型：
python
运行
from pipeline.system import create_test_video

# 生成5秒的测试视频
video_path = create_test_video(output_path="test_video.mp4", duration=5)
2. 运行跟踪系统
修改main.py中的类别列表和视频路径，然后运行：
bash
运行
python main.py
示例代码：
python
运行
# 定义目标类别
class_names = ["red_box", "blue_box", "person", "car"]

# 初始化跟踪系统
mot_system = OpenVocabMOTSystem(class_names)

# 处理视频
video_path = "test_video.mp4"
output_path = "./output_video.mp4"
results = mot_system.process_video(video_path, output_path)
模块说明
跨模态词典：融合视觉和语言特征，建立类别与特征的映射关系
原型记忆：维护轨迹级别的特征原型，支持在线聚类发现新类别
可靠性评估：多维度评估视觉和语言模态的可靠性，动态调整权重
零样本处理：处理未知类别目标，通过知识图谱和语义演化进行类别推断
知识图谱：提供类别间的层级关系，增强语义理解能力
实验配置
EXPERIMENT_CONFIG中定义了多种实验配置，包括基线模型和消融实验设置，可通过修改配置进行不同场景的性能评估。
输出说明
系统输出包括：
处理后的视频文件（带跟踪框和类别标签）
跟踪结果数据（包含目标 ID、边界框和类别信息）
实验日志和评估指标
注意事项
首次运行可能需要下载 YOLO 和 CLIP 模型
知识图谱嵌入可通过knowledge_graph/generate_kg_embeddings.py生成
对于大型数据集，建议使用 GPU 加速（设置MODEL_CONFIG["device"] = "cuda"）